<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" type="text/css" th:href="@{/layui/css/layui.css}">
</head>
<br>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
    <legend>拖拽上传</legend>
</fieldset>

<div class="layui-upload-drag" id="test10">
    <i class="layui-icon"></i>
    <p>YApi导入点击上传，或将文件拖拽到此处</p>
    <div class="layui-hide" id="uploadDemoView">
        <hr>
        <img src="" alt="上传成功后渲染" style="max-width: 196px">
    </div>
</div>
<div class="layui-upload-drag" id="test11">
    <i class="layui-icon"></i>
    <p>SwaggerApi导入点击上传，或将文件拖拽到此处</p>
    <div class="layui-hide" id="uploadDemoView2">
        <hr>
        <img src="" alt="上传成功后渲染" style="max-width: 196px">
    </div>
</div>
<a target="_blank" href="/devops/export">下载</a>



</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>


<form class="layui-form" lay-filter="example">

    <div class="layui-form-item">
        <label class="layui-form-label">接口类型</label>
        <div class="layui-input-block">
            <input type="radio" name="agreement" value="http" title="http" checked="">
            <input type="radio" name="agreement" value="https" title="https">
            <input type="radio" name="agreement" value="webService" title="webService">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">基本路径</label>
        <div class="layui-input-block">
            <input type="text" name="url" lay-verify="title" autocomplete="off" placeholder="127.0.0.1:8080/devops/autotest/apiManagement/createGroup" class="layui-input">
        </div>
    </div>
    <div id="methodArea" class="layui-form-item">
        <label class="layui-form-label">请求方式</label>
        <div class="layui-input-block">
            <input type="radio" name="method" value="GET" title="GET" checked="">
            <input type="radio" name="method" value="POST" title="POST">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">请求头1</label>
        <div class="layui-input-inline">
            <input type="text" name="header1-name"  placeholder="名称" autocomplete="off" class="layui-input">
            <input type="text" name="header1-value"  placeholder="值" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">请求头2</label>
        <div class="layui-input-inline">
            <input type="text" name="header2-name" placeholder="名称" autocomplete="off" class="layui-input">
            <input type="text" name="header2-value" placeholder="值" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">请求参数1</label>
        <div class="layui-input-inline">
            <input type="text" name="param1-name"  placeholder="参数名" autocomplete="off" class="layui-input">
            <input type="text" name="param1-value"  placeholder="值" autocomplete="off" class="layui-input">

        </div>
        <label class="layui-form-label">请求参数2</label>
        <div class="layui-input-inline">
            <input type="text" name="param2-name" placeholder="名称" autocomplete="off" class="layui-input">
            <input type="text" name="param2-value" placeholder="值" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">请求参数3</label>
        <div class="layui-input-inline">
            <input type="text" name="param3-name"  placeholder="名称" autocomplete="off" class="layui-input">
            <input type="text" name="param3-value"  placeholder="值" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">请求参数4</label>
        <div class="layui-input-inline">
            <input type="text" name="param4-name" placeholder="名称" autocomplete="off" class="layui-input">
            <input type="text" name="param4-value" placeholder="值" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div id="bodyArea" class="layui-form-item layui-form-text">
      <label class="layui-form-label">请求Body</label>
      <div class="layui-input-block">
        <textarea class="layui-textarea" name="body" lay-verify="content" id="LAY_demo_editor"></textarea>
      </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">参数断言</label>
        <div class="layui-input-inline">
            <input type="text" name="assert1-name"  placeholder="参数名" autocomplete="off" class="layui-input">
            <input type="text" name="assert1-value"  placeholder="值" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">JSON断言</label>
        <div class="layui-input-inline">
            <input type="text" name="assert1-name"  placeholder="参数名" autocomplete="off" class="layui-input">
            <input type="text" name="assert1-value"  placeholder="值" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-input-block">
            <button type="button" class="layui-btn layui-btn-normal" id="LAY-component-form-setval">赋值</button>
            <button type="button" class="layui-btn layui-btn-normal" id="LAY-component-form-getval">取值</button>
            <button type="button" lay-submit="" class="layui-btn" lay-filter="demo1">执行测试</button>
        </div>
    </div>
</form>

<!--<input id="agreement" th:value="协议">-->
<!--<input id="path" th:value="基本路径">-->
<!--<input id="method" th:value="请求方式">-->
<!--<input id="header1" th:value="请求头1">-->
<!--<input id="header2" th:value="请求头2">-->
<!--<input id="header3" th:value="请求头3">-->
<!--<input id="header4" th:value="请求头4">-->

<!--<input id="test" th:value="执行测试">-->




</body>

<script type="text/javascript" th:src="@{/layui/layui.js}"></script>
<script>

    layui.use(['form','layedit','code','upload'],function () {
        var $ = layui.jquery
            ,upload = layui.upload
            ,form = layui.form
            ,layedit = layui.layedit;

        //创建一个编辑器
        var editIndex = layedit.build('LAY_demo_editor');

        layui.code();
        //表单取值
        layui.$('#LAY-component-form-getval').on('click', function(){
            var data = form.val('example');
            data.body= layedit.getText(editIndex);
            alert(JSON.stringify(data));
        });
        form.on('submit(demo1)', function(data){
            // var param = data.field;
            // param.photoUri = param.photoUrl.split(",");
            // param.videoUri = param.videoUrl.split(",");
            // var latlngArr = param.latlng.split(",");
            // param.latlng = {lat: latlngArr[0], lng: latlngArr[1]};
            //console.log(form.val("example"));
            var json = form.val("example");
            json.body = layedit.getText(editIndex);
            $.ajax({
                url:'/devops/autotest/restAssured',
                type:'post',
                dataType:'json',
                contentType:'application/json;charset=UTF-8',
                data:JSON.stringify(json),
                success:function (data) {
                    alert(data)
                }
            });
//					layer.alert(JSON.stringify(param), {
//				      title: '最终的提交信息'
//				    })
            return false;// 阻止表单跳转。如果需要表单跳转,去掉这段即可。
        });

        //拖拽上传
        upload.render({
            elem: '#test10'
            , accept: 'file'
            , data: {
                type: 'yapi',//SwaggerApi
                mode: 'smart'//Smart
            }
            , url: '/devops/import' //改成您自己的上传接口
            , done: function (res) {
                console.log(res)
                alert("" + res.toString())
            }
        });
        //拖拽上传
        upload.render({
            elem: '#test11'
            , accept: 'file'
            , data: {
                type: 'swagger',//SwaggerApi
                mode: 'normal'//Smart
            }
            , url: '/devops/import' //改成您自己的上传接口
            , done: function (res) {
                console.log(res)
                alert("" + res.toString())
            }
        });
        //
        // $.ajax({
        //     url:'/devops/autotest/apiManagement/createGroup',
        //     type:'post',
        //     contentType: "application/json;charset=utf-8",//这个参数也是header参数
        //     data:JSON.stringify({
        //         "groupName":"阿波罗devops测试环境",
        //         "basepath":"127.0.0.1/gov"
        //     }),
        //     headers: {
        //         'X-User-Token':'xxxxx'
        //     },
        //     dataType:'json',
        //     success:function(data){
        //     }
        // });

        $.ajax({
            url:'/devops/autotest/yapi',
            type:'post',
            contentType: "application/json;charset=utf-8",//这个参数也是header参数
            data:JSON.stringify([
                {
                    "index": 0,
                    "name": "公共分类",
                    "desc": "公共分类",
                    "add_time": 1586686494,
                    "up_time": 1586686494,
                    "list": [
                    ]
                },
                {
                    "index": 0,
                    "name": "用户管理相关接口",
                    "desc": null,
                    "add_time": 1586763154,
                    "up_time": 1586763154,
                    "list": [

                    ]
                }
            ]),
            headers: {
                'X-User-Token':'xxxxx'
            },
            dataType:'json',
            success:function(data){
            }
        });






        //
        // $.ajax({
        //     url:'/devops/autotest/apiManagement/createApi',
        //     type:'post',
        //     contentType: "application/json;charset=utf-8",//这个参数也是header参数
        //     data:JSON.stringify({
        //         "groupId": 1,
        //         "type": "HTTP",
        //         "name": "接口名称",
        //         "path": "/devops/add",
        //         "method": "GET",
        //         "reqBodyType": "json",
        //         "reqBody": "{\"type\":\"object\",\"properties\":{\"groupName\":{\"type\":\"string\",\"description\":\"分组名称\"},\"basepath\":{\"type\":\"string\",\"description\":\"基本路径\"}},\"required\":[\"groupName\",\"basepath\"]}",
        //         "reqQuery": [
        //             {
        //                 "name": "id",
        //                 "required": "0"
        //             },
        //             {
        //                 "sex": "男",
        //                 "required": "1"
        //             }
        //         ],
        //         "reqHeaders": [
        //             {
        //                 "name": "Content-Type",
        //                 "value": "application/json"
        //             },
        //             {
        //                 "name": "X-User-Token",
        //                 "value": "xxxxx"
        //             }
        //         ],
        //         "resBody":"{\"type\":\"object\",\"properties\":{\"groupName\":{\"type\":\"string\",\"description\":\"分组名称\"},\"basepath\":{\"type\":\"string\",\"description\":\"基本路径\"}},\"required\":[\"groupName\",\"basepath\"]}"
        //     }),
        //     headers: {
        //         'X-User-Token':'xxxxx'
        //     },
        //     dataType:'json',
        //     success:function(data){
        //     }
        // });



        // $.ajax({
        //     url:'/devops/autotest/apiManagement/deleteApis',
        //     type:'post',
        //     contentType: "application/json;charset=utf-8",//这个参数也是header参数
        //     data:JSON.stringify([1,2,3,4]),
        //     headers: {
        //         'X-User-Token':'xxxxx'
        //     },
        //     dataType:'json',
        //     success:function(data){
        //     }
        // });
    });
</script>
</html>